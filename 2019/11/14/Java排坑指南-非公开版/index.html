
<!DOCTYPE html>
<html lang="zh-Hans">


<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#202020">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>
  
  
    <meta name="keywords" content="Java,">
  

  
    <meta name="description" content="thevay">
  
  
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <title>Java排坑指南(非公开版) [ thevay ]</title>
  
    <!-- stylesheets list from config.yml -->
    
      <link rel="stylesheet" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css">
    
      <link rel="stylesheet" href="/css/xoxo.css">
    
  
</head>


<body>
  <div class="nav-container">
    <nav class="home-menu pure-menu pure-menu-horizontal">
  <a class="pure-menu-heading" href="/">
    <img class="avatar" src="http://thevay.github.io/images/logo.png">
    <span class="title">thevay</span>
  </a>

  <ul class="pure-menu-list clearfix">
      
          
            <li class="pure-menu-item"><a href="/" class="pure-menu-link">首页</a></li>
          
      
          
            <li class="pure-menu-item"><a href="/archives" class="pure-menu-link">归档</a></li>
          
      
          
            <li class="pure-menu-item"><a href="/tags" class="pure-menu-link">标签</a></li>
          
      
          
            <li class="pure-menu-item"><a href="/search" class="pure-menu-link">搜索</a></li>
          
      
          
            <li class="pure-menu-item"><a href="/about" class="pure-menu-link">关于</a></li>
          
      
  </ul>
   
</nav>
  </div>

  <div class="container" id="content-outer">
    <div class="inner" id="content-inner">
      <link rel="stylesheet" href="/css/needsharebutton.min.css">
<div class="post-container">
  <article class="post" id="post">
    <header class="post-header text-center">
      <h1 class="title">
        Java排坑指南(非公开版)
      </h1>
      <span>
        
        <time class="time" datetime="2019-11-14T02:39:35.000Z">
        2019-11-14
      </time>
        
      </span>
      <span class="slash">/</span>
      <span class="post-meta">
      <span class="post-tags">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li></ul>
      </span>
    </span>
      <span class="slash">/</span>
      <span class="read">
      <span id="busuanzi_value_page_pv"></span> 点击
    </span>
      <span class="slash">/</span>
      <span class="read">阅读耗时 11分</span>
    </header>

    <div class="post-content">
      <p>这里记录一个排坑清单，我们没有必要纠结什么对，什么是错。但我们有必要知道什么是优，什么是劣。 </p>
<p>以下奉上满汉坑单一张（不定期更新排雷进度）</p>
<a id="more"></a>

<h3 id="1-尽量使用Collection-isEmpty-检测空"><a href="#1-尽量使用Collection-isEmpty-检测空" class="headerlink" title="1. 尽量使用Collection.isEmpty()检测空"></a>1. 尽量使用Collection.isEmpty()检测空</h3><p>使用Collection.size()来检测空在逻辑上没有问题，但是使用Collection.isEmpty()使得代码更易读，<br>并且可以获得更好的性能。</p>
<p>任何Collection.isEmpty()实现的时间复杂度都是O(1),但是某些Collection.size()实现的时间复杂度是O(n)。</p>
<p>反例：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(collection.size() == <span class="number">0</span>){}</span><br></pre></td></tr></tbody></table></figure>

<p>正例：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(collection.isEmpty()){}</span><br></pre></td></tr></tbody></table></figure>

<p>判空：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CollectionUtils.isEmpty(collection)</span><br><span class="line">CollectionUtils.isNotEmpty(collection)</span><br></pre></td></tr></tbody></table></figure>

<h3 id="2-集合初始化尽量指定大小"><a href="#2-集合初始化尽量指定大小" class="headerlink" title="2. 集合初始化尽量指定大小"></a>2. 集合初始化尽量指定大小</h3><p>Java 的集合类用起来十分方便，但是看源码可知，集合也是有大小限制的。每次扩容的时间复杂度很有可能是<br>O(n),所以尽量指定可预知的集合大小，能减少集合的扩容次数。</p>
<p>反例：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span>[] arr = <span class="keyword">new</span> <span class="keyword">int</span>[]{<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>};</span><br><span class="line">List&lt;Integer&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i : arr) {</span><br><span class="line">    list.add(i);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>正例：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span>[] arr = <span class="keyword">new</span> <span class="keyword">int</span>[]{<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>};</span><br><span class="line">List&lt;Integer&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;(arr.length);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i : arr) {</span><br><span class="line">    list.add(i);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="3-Tip-可以使用ONDUPLICATE-KEY-UPDATE-和唯一索引实现SQL批量插入更新操作"><a href="#3-Tip-可以使用ONDUPLICATE-KEY-UPDATE-和唯一索引实现SQL批量插入更新操作" class="headerlink" title="3. [Tip]可以使用ONDUPLICATE KEY UPDATE 和唯一索引实现SQL批量插入更新操作"></a>3. [Tip]可以使用ONDUPLICATE KEY UPDATE 和唯一索引实现SQL批量插入更新操作</h3><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;insert id="insertOrUpdateCameraInfoByOne" paramerType="com.pojo.AreaInfo"&gt;</span><br><span class="line">    <span class="keyword">insert</span> <span class="keyword">into</span> camera_info( cameraId,zone1Id,zone1Name,zone2Id,zone2Name,zone3Id,zone3Name,zone4Id,zone4Name）</span><br><span class="line">    <span class="keyword">VALUES</span>(</span><br><span class="line">        <span class="comment">#{cameraId},#{zone1Id},#{zone1Name}, #{zone2Id},</span></span><br><span class="line">        <span class="comment">#{zone2Name}, #{zone3Id}, #{zone3Name},</span></span><br><span class="line">        <span class="comment">#{zone4Id}, #{zone4Name},)</span></span><br><span class="line">    <span class="keyword">ON</span> <span class="keyword">DUPLICATE</span> <span class="keyword">KEY</span> <span class="keyword">UPDATE</span> </span><br><span class="line">    cameraId = <span class="keyword">VALUES</span>(cameraId),</span><br><span class="line">    zone1Id = <span class="keyword">VALUES</span>(zone1Id),zone1Name = <span class="keyword">VALUES</span>(zone1Name),</span><br><span class="line">    zone2Id = <span class="keyword">VALUES</span>(zone2Id),zone2Name = <span class="keyword">VALUES</span>(zone2Name),</span><br><span class="line">    zone3Id = <span class="keyword">VALUES</span>(zone3Id),zone3Name = <span class="keyword">VALUES</span>(zone3Name),</span><br><span class="line">    zone4Id = <span class="keyword">VALUES</span>(zone4Id),zone4Name = <span class="keyword">VALUES</span>(zone4Name)</span><br><span class="line">&lt;/<span class="keyword">insert</span>&gt;</span><br></pre></td></tr></tbody></table></figure>

<h3 id="4-不要把集合对象传给自己"><a href="#4-不要把集合对象传给自己" class="headerlink" title="4. 不要把集合对象传给自己"></a>4. 不要把集合对象传给自己</h3><p>由于某些方法要求参数在执行期间保持不变，因此将集合传递给自身可能会导致异常行为。</p>
<p>反例：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">list.add(<span class="string">"Hello"</span>);</span><br><span class="line">list.add(<span class="string">"World"</span>);</span><br><span class="line"><span class="keyword">if</span> (list.containsAll(list)) {}<span class="comment">// 无意义,总是返回true</span></span><br><span class="line">list.removeAll(list); <span class="comment">// 性能差, 直接使用clear()</span></span><br></pre></td></tr></tbody></table></figure>

<h3 id="5-字符串拼接使用-StringBuilder"><a href="#5-字符串拼接使用-StringBuilder" class="headerlink" title="5. 字符串拼接使用 StringBuilder"></a>5. 字符串拼接使用 StringBuilder</h3><p>一般的字符串拼接在编译期 java 会进行优化，但是在循环中字符串拼接， java 编译期无法做到<br>优化，所以需要使用 StringBuilder 进行替换。</p>
<p>反例：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">String s = <span class="string">""</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) {</span><br><span class="line">    s += i;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>正例：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">String a = <span class="string">"a"</span>;</span><br><span class="line">String b = <span class="string">"b"</span>;</span><br><span class="line">String c = <span class="string">"c"</span>;</span><br><span class="line">String s = a + b + c; <span class="comment">// 没问题，java编译器会进行优化</span></span><br><span class="line">StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) {</span><br><span class="line">    sb.append(i);  <span class="comment">// 循环中，java编译器无法进行优化，所以要手动使用StringBuilder</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="6-枚举的属性字段必须是私有不可变"><a href="#6-枚举的属性字段必须是私有不可变" class="headerlink" title="6. 枚举的属性字段必须是私有不可变"></a>6. 枚举的属性字段必须是私有不可变</h3><p>枚举通常被当做常量使用，如果枚举中存在公共属性字段或设置字段方法，那么这些枚举常量的属性很容易被修改。<br>理想情况下，枚举中的属性字段是私有的，并在私有构造函数中赋值，没有对应的 Setter 方法，最好加上 final 修饰符。</p>
<p>反例：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> UserStatus {</span><br><span class="line">    DISABLED(<span class="number">0</span>, <span class="string">"禁用"</span>),</span><br><span class="line">    ENABLED(<span class="number">1</span>, <span class="string">"启用"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> value;</span><br><span class="line">    <span class="keyword">private</span> String description;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">UserStatus</span><span class="params">(<span class="keyword">int</span> value, String description)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.value = value;</span><br><span class="line">        <span class="keyword">this</span>.description = description;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDescription</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> description;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDescription</span><span class="params">(String description)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.description = description;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>正例：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> UserStatus {</span><br><span class="line">    DISABLED(<span class="number">0</span>, <span class="string">"禁用"</span>),</span><br><span class="line">    ENABLED(<span class="number">1</span>, <span class="string">"启用"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> value;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String description;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">UserStatus</span><span class="params">(<span class="keyword">int</span> value, String description)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.value = value;</span><br><span class="line">        <span class="keyword">this</span>.description = description;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getValue</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDescription</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> description;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="7-小心String-split-String-regex"><a href="#7-小心String-split-String-regex" class="headerlink" title="7. 小心String.split(String regex)"></a>7. 小心String.split(String regex)</h3><p>字符串 String 的 split 方法，传入的分隔字符串是<strong>正则表达式</strong>！部分关键字（比如.<a href=""></a>| 等）需要转义</p>
<p>反例：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"a.ab.abc"</span>.split(<span class="string">"."</span>); <span class="comment">// 结果为[]</span></span><br><span class="line"><span class="string">"a|ab|abc"</span>.split(<span class="string">"|"</span>); <span class="comment">// 结果为["a", "|", "a", "b", "|", "a", "b", "c"]</span></span><br></pre></td></tr></tbody></table></figure>

<p>正例：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"a.ab.abc"</span>.split(<span class="string">"\\."</span>); <span class="comment">// 结果为["a", "ab", "abc"]</span></span><br><span class="line"><span class="string">"a|ab|abc"</span>.split(<span class="string">"\\|"</span>); <span class="comment">// 结果为["a", "ab", "abc"]</span></span><br></pre></td></tr></tbody></table></figure>

<h3 id="8-Tip-Java-9改进了String、StringBuffer、StringBuilder"><a href="#8-Tip-Java-9改进了String、StringBuffer、StringBuilder" class="headerlink" title="8. [Tip] Java 9改进了String、StringBuffer、StringBuilder"></a>8. [Tip] Java 9改进了String、StringBuffer、StringBuilder</h3><p>Java 提供String、StringBuffer、StingBuilder 封装字符串</p>
<p>String类是不可变类，String对象被创建后，包含在这个对象的字符序列不可改变</p>
<p>StringBuffer 对象代表一个字符序列可变的字符串，创建后通过append()、insert()等方法改变字符序列，最后调用<br>toString() 方法转换为String对象</p>
<p>StringBuilder也代表可变字符串对象，与StringBuffer区别在于StringBuffer线程安全，StringBuilder没有实现<br>线程安全，所以性能略高。</p>
<p>Java 9 改进了字符串的实现，之前使用char[] 保存字符，Java 9 改用Byte[]<strong>更加节省空间</strong>。</p>
<blockquote>
<p>字符串拼接原理：运行时,两个字符串str1,str2的拼接首先会调用 String.valueOf(obj),这个Obj为str1,而<br>String.valueOf(Obj)中的实现是return obj == null ? “null” : obj.toString(), 然后产生StringBuilder,调<br>用的StringBuilder(str1)构造方法,把StringBuilder初始化,长度为str1.length()+16,并且调用append(str1)！接<br>下来调用StringBuilder.append(str2)，把第二个字符串拼接进去,然后调用StringBuilder.toString返回结果！</p>
</blockquote>
<h3 id="9-需要-Map-的主键和取值时，应该迭代-entrySet"><a href="#9-需要-Map-的主键和取值时，应该迭代-entrySet" class="headerlink" title="9. 需要 Map 的主键和取值时，应该迭代 entrySet()"></a>9. 需要 Map 的主键和取值时，应该迭代 entrySet()</h3><p>当循环中只需要 Map 的主键时，迭代 keySet() 是正确的。<br>但是，当需要主键和取值时，迭代 entrySet() 才是更高效的做法，比先迭代 keySet() 后再去 get 取值性能更佳。</p>
<p>反例：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Map&lt;String, String&gt; map = ...;</span><br><span class="line"><span class="keyword">for</span> (String key : map.keySet()) {</span><br><span class="line">    String value = map.get(key);</span><br><span class="line">    ...</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>正例：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Map&lt;String, String&gt; map = ...;</span><br><span class="line"><span class="keyword">for</span> (Map.Entry&lt;String, String&gt; entry : map.entrySet()) {</span><br><span class="line">    String key = entry.getKey();</span><br><span class="line">    String value = entry.getValue();</span><br><span class="line">    ...</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="10-集合初始化尽量指定大小"><a href="#10-集合初始化尽量指定大小" class="headerlink" title="10. 集合初始化尽量指定大小"></a>10. 集合初始化尽量指定大小</h3><p>java 的集合类用起来十分方便，但是看源码可知，集合也是有大小限制的。<br>每次扩容的时间复杂度很有可能是 O(n) ，所以尽量指定可预知的集合大小，能减少集合的扩容次数。</p>
<p>反例：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span>[] arr = <span class="keyword">new</span> <span class="keyword">int</span>[]{<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>};</span><br><span class="line">List&lt;Integer&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i : arr) {</span><br><span class="line">    list.add(i);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>正例：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span>[] arr = <span class="keyword">new</span> <span class="keyword">int</span>[]{<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>};</span><br><span class="line">List&lt;Integer&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;(arr.length);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i : arr) {</span><br><span class="line">    list.add(i);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="11-List-的随机访问"><a href="#11-List-的随机访问" class="headerlink" title="11. List 的随机访问"></a>11. List 的随机访问</h3><p>大家都知道数组和链表的区别：数组的随机访问效率更高。</p>
<p>当调用方法获取到 List 后，如果想随机访问其中的数据，并不知道该数组内部实现是链表还是数组，怎么办呢？<br>可以判断它是否实现* RandomAccess 接口。</p>
<p>正例：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 调用别人的服务获取到list</span></span><br><span class="line">List&lt;Integer&gt; list = otherService.getList();</span><br><span class="line"><span class="keyword">if</span> (list <span class="keyword">instanceof</span> RandomAccess) {</span><br><span class="line">    <span class="comment">// 内部数组实现，可以随机访问</span></span><br><span class="line">    System.out.println(list.get(list.size() - <span class="number">1</span>));</span><br><span class="line">} <span class="keyword">else</span> {</span><br><span class="line">    <span class="comment">// 内部可能是链表实现，随机访问效率低</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="12-频繁调用-Collection-contains-方法请使用-Set"><a href="#12-频繁调用-Collection-contains-方法请使用-Set" class="headerlink" title="12. 频繁调用 Collection.contains 方法请使用 Set"></a>12. 频繁调用 Collection.contains 方法请使用 Set</h3><p>在 java 集合类库中，List 的 contains 方法普遍时间复杂度是 O(n)<br>如果在代码中需要频繁调用 contains 方法查找数据，可以先将 list 转换成 HashSet 实现，将 O(n) 的时间复杂度降为 O(1) 。</p>
<p>反例：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ArrayList&lt;Integer&gt; list = otherService.getList();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= Integer.MAX_VALUE; i++) {</span><br><span class="line">    <span class="comment">// 时间复杂度O(n)</span></span><br><span class="line">    list.contains(i);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>正例：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ArrayList&lt;Integer&gt; list = otherService.getList();</span><br><span class="line">Set&lt;Integer&gt; set = <span class="keyword">new</span> HashSet(list);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= Integer.MAX_VALUE; i++) {</span><br><span class="line">    <span class="comment">// 时间复杂度O(1)</span></span><br><span class="line">    set.contains(i);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="13-不要使用魔法值"><a href="#13-不要使用魔法值" class="headerlink" title="13. 不要使用魔法值"></a>13. 不要使用魔法值</h3><p>当你编写一段代码时，使用魔法值可能看起来很明确，但在调试时它们却不显得那么明确了。<br>这就是为什么需要把魔法值定义为可读取常量的原因。但是，-1、0 和 1不被视为魔法值</p>
<p>反例：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++){</span><br><span class="line">    ...</span><br><span class="line">}</span><br><span class="line"><span class="keyword">if</span> (a == <span class="number">100</span>) {</span><br><span class="line">    ...</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>正例：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> MAX_COUNT = <span class="number">100</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; MAX_COUNT; i++){</span><br><span class="line">    ...</span><br><span class="line">}</span><br><span class="line"><span class="keyword">if</span> (count == MAX_COUNT) {</span><br><span class="line">    ...</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="14-建议使用-try-with-resources-语句"><a href="#14-建议使用-try-with-resources-语句" class="headerlink" title="14. 建议使用 try-with-resources 语句"></a>14. 建议使用 try-with-resources 语句</h3><p>Java 7 中引入了 try-with-resources 语句，该语句能保证将相关资源关闭，优于原来的 try-catch-finally 语句，并且使程序代码更安全更简洁。</p>
<p>反例：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">(String fileName)</span> </span>{</span><br><span class="line">    BufferedReader reader = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> {</span><br><span class="line">        String line;</span><br><span class="line">        reader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> FileReader(fileName));</span><br><span class="line">        <span class="keyword">while</span> ((line = reader.readLine()) != <span class="keyword">null</span>) {</span><br><span class="line">            ...</span><br><span class="line">        }</span><br><span class="line">    } <span class="keyword">catch</span> (Exception e) {</span><br><span class="line">        ...</span><br><span class="line">    } <span class="keyword">finally</span> {</span><br><span class="line">        <span class="keyword">if</span> (reader != <span class="keyword">null</span>) {</span><br><span class="line">            <span class="keyword">try</span> {</span><br><span class="line">                reader.close();</span><br><span class="line">            } <span class="keyword">catch</span> (IOException e) {</span><br><span class="line">                ...</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>正例：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">(String fileName)</span> </span>{</span><br><span class="line">    <span class="keyword">try</span> (BufferedReader reader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> FileReader(fileName))) {</span><br><span class="line">        String line;</span><br><span class="line">        <span class="keyword">while</span> ((line = reader.readLine()) != <span class="keyword">null</span>) {</span><br><span class="line">            ...</span><br><span class="line">        }</span><br><span class="line">    } <span class="keyword">catch</span> (Exception e) {</span><br><span class="line">        ...</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>Ref: <a href="https://www.cnblogs.com/yueshutong/p/10725477.html" target="_blank" rel="noopener">https://www.cnblogs.com/yueshutong/p/10725477.html</a></p>
<h3 id="15-建议删除未使用的私有方法和字段"><a href="#15-建议删除未使用的私有方法和字段" class="headerlink" title="15. 建议删除未使用的私有方法和字段"></a>15. 建议删除未使用的私有方法和字段</h3><p>删除未使用的私有方法和字段，使代码更简洁更易维护。若有需要再使用，可以从历史提交中找回。</p>
<p>反例：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DoubleDemo1</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> unusedField = <span class="number">100</span>;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">unusedMethod</span><span class="params">()</span> </span>{</span><br><span class="line">        ...</span><br><span class="line">    }</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> a + b;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>正例：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DoubleDemo1</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> a + b;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<blockquote>
<p><strong>代码膨胀</strong>是稍微有点规模的项目都会遇到的问题，在《人月神话》中也有提及。有规模的工程项目都是团队的产<br>物，既然是团队的产物，那么不可能不存在重复的代码，而这种重复的代码随着团队人员的增多，代码规模的增<br>加会更加的突出。这是一个必然存在的问题，不管是你的团队成员多么的优秀，规模的工程项目必然会存在，只<br>不过是优秀的团队使得这种重复和混乱的增长速度变得小了而已。</p>
</blockquote>
<h3 id="16-工具类应该屏蔽构造函数"><a href="#16-工具类应该屏蔽构造函数" class="headerlink" title="16. 工具类应该屏蔽构造函数"></a>16. 工具类应该屏蔽构造函数</h3><p>工具类是一堆静态字段和函数的集合，不应该被实例化。但是，Java 为每个没有明确定义构造函数的类添加了一个隐式公有构造函数。<br>所以，为了避免 java “小白”使用有误，应该显式定义私有构造函数来屏蔽这个隐式公有构造函数。</p>
<p>反例：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MathUtils</span> </span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">double</span> PI = <span class="number">3.1415926</span>D;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> a + b;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>正例：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MathUtils</span> </span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">double</span> PI = <span class="number">3.1415926</span>D;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">MathUtils</span><span class="params">()</span> </span>{}</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> a + b;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="17-删除多余的异常捕获并抛出"><a href="#17-删除多余的异常捕获并抛出" class="headerlink" title="17. 删除多余的异常捕获并抛出"></a>17. 删除多余的异常捕获并抛出</h3><p>用 catch 语句捕获异常后，什么也不进行处理，就让异常重新抛出，这跟不捕获异常的效果一样，可以删除这块代码或添加别的处理。</p>
<p>反例：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> String <span class="title">readFile</span><span class="params">(String fileName)</span> <span class="keyword">throws</span> IOException </span>{</span><br><span class="line">    <span class="keyword">try</span> (BufferedReader reader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> FileReader(fileName))) {</span><br><span class="line">        String line;</span><br><span class="line">        StringBuilder builder = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        <span class="keyword">while</span> ((line = reader.readLine()) != <span class="keyword">null</span>) {</span><br><span class="line">            builder.append(line);</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> builder.toString();</span><br><span class="line">    } <span class="keyword">catch</span> (Exception e) {</span><br><span class="line">        <span class="keyword">throw</span> e;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>正例：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> String <span class="title">readFile</span><span class="params">(String fileName)</span> <span class="keyword">throws</span> IOException </span>{</span><br><span class="line">    <span class="keyword">try</span> (BufferedReader reader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> FileReader(fileName))) {</span><br><span class="line">        String line;</span><br><span class="line">        StringBuilder builder = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        <span class="keyword">while</span> ((line = reader.readLine()) != <span class="keyword">null</span>) {</span><br><span class="line">            builder.append(line);</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> builder.toString();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="18-使用String-valueOf-value-代替””-value"><a href="#18-使用String-valueOf-value-代替””-value" class="headerlink" title="18. 使用String.valueOf(value)代替””+value"></a>18. 使用String.valueOf(value)代替””+value</h3><p>当要把其它对象或类型转化为字符串时，使用 String.valueOf(value) 比””+value 的效率更高。</p>
<p>反例：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> i = <span class="number">1</span>;</span><br><span class="line">String s = <span class="string">""</span> + i;</span><br></pre></td></tr></tbody></table></figure>

<p>正例：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> i = <span class="number">1</span>;</span><br><span class="line">String s = String.valueOf(i);</span><br></pre></td></tr></tbody></table></figure>

<h3 id="19-优先使用常量或确定值来调用-equals-方法"><a href="#19-优先使用常量或确定值来调用-equals-方法" class="headerlink" title="19. 优先使用常量或确定值来调用 equals 方法"></a>19. 优先使用常量或确定值来调用 equals 方法</h3><p>对象的 equals 方法容易抛空指针异常，应使用常量或确定有值的对象来调用 equals 方法。当然，使用<br>java.util.Objects.equals() 方法是最佳实践。</p>
<p>反例：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">isFinished</span><span class="params">(OrderStatus status)</span> </span>{</span><br><span class="line">    <span class="keyword">return</span> status.equals(OrderStatus.FINISHED); <span class="comment">// 可能抛空指针异常</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>正例：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">isFinished</span><span class="params">(OrderStatus status)</span> </span>{</span><br><span class="line">    <span class="keyword">return</span> OrderStatus.FINISHED.equals(status);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">isFinished</span><span class="params">(OrderStatus status)</span> </span>{</span><br><span class="line">    <span class="keyword">return</span> Objects.equals(status, OrderStatus.FINISHED);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>Best Ref: <a href="https://mp.weixin.qq.com/s/1aAwroGRSGWrzgE6XpPx7Q" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/1aAwroGRSGWrzgE6XpPx7Q</a></p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
    </div>

    <div style="witdh:100%;text-align:center">
      welcome to reprint ~ <br/>
      <div id="share-button"class="need-share-button-default" data-share-position="Center" data-share-networks="Wechat,Weibo,RenRen,Facebook,GooglePlus,Linkedin">Share</div>
    </div>
  </article>
  <div class="toc-container">
    
  <div id="toc" class="toc-article">
    <strong class="toc-title">目录</strong>
    <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-尽量使用Collection-isEmpty-检测空"><span class="toc-text">1. 尽量使用Collection.isEmpty()检测空</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-集合初始化尽量指定大小"><span class="toc-text">2. 集合初始化尽量指定大小</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Tip-可以使用ONDUPLICATE-KEY-UPDATE-和唯一索引实现SQL批量插入更新操作"><span class="toc-text">3. [Tip]可以使用ONDUPLICATE KEY UPDATE 和唯一索引实现SQL批量插入更新操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-不要把集合对象传给自己"><span class="toc-text">4. 不要把集合对象传给自己</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-字符串拼接使用-StringBuilder"><span class="toc-text">5. 字符串拼接使用 StringBuilder</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-枚举的属性字段必须是私有不可变"><span class="toc-text">6. 枚举的属性字段必须是私有不可变</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-小心String-split-String-regex"><span class="toc-text">7. 小心String.split(String regex)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-Tip-Java-9改进了String、StringBuffer、StringBuilder"><span class="toc-text">8. [Tip] Java 9改进了String、StringBuffer、StringBuilder</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-需要-Map-的主键和取值时，应该迭代-entrySet"><span class="toc-text">9. 需要 Map 的主键和取值时，应该迭代 entrySet()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-集合初始化尽量指定大小"><span class="toc-text">10. 集合初始化尽量指定大小</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-List-的随机访问"><span class="toc-text">11. List 的随机访问</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-频繁调用-Collection-contains-方法请使用-Set"><span class="toc-text">12. 频繁调用 Collection.contains 方法请使用 Set</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-不要使用魔法值"><span class="toc-text">13. 不要使用魔法值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-建议使用-try-with-resources-语句"><span class="toc-text">14. 建议使用 try-with-resources 语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#15-建议删除未使用的私有方法和字段"><span class="toc-text">15. 建议删除未使用的私有方法和字段</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16-工具类应该屏蔽构造函数"><span class="toc-text">16. 工具类应该屏蔽构造函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#17-删除多余的异常捕获并抛出"><span class="toc-text">17. 删除多余的异常捕获并抛出</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#18-使用String-valueOf-value-代替””-value"><span class="toc-text">18. 使用String.valueOf(value)代替””+value</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#19-优先使用常量或确定值来调用-equals-方法"><span class="toc-text">19. 优先使用常量或确定值来调用 equals 方法</span></a></li></ol>
  </div>



  </div>
  <script src="/js/needsharebutton.js"></script>
  <script>
    new needShareButton(document.getElementById('share-button'));
  </script>
</div>
<section id="comments">
      <div id="valine_thread" style="margin: 30px;"></div>
            <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
            <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
            <script>
                var GUEST_INFO = ['nick','mail','link'];
                var guest_info = 'nick,mail,link'.split(',').filter(function(item){
                    return GUEST_INFO.indexOf(item) > -1
                });
                var notify = 'true' == true;
                var verify = 'true' == true;
                var valine = new Valine();
                valine.init({
                    el: '#valine_thread',
                    notify: notify,
                    verify: verify,
                    appId: "c5nACLtjaK7VBhs0HF1sWYdI-gzGzoHsz",
                    appKey: "Ch0YJ5jvWmsTlOTruXAilVcr",
                    placeholder: "ヾﾉ≧∀≦)o快来评论一下吧!",
                    pageSize:'10',
                    avatar:'robohash',
                    lang:'zh-cn'
                })
            </script>
    </section>
<div class="copyright">
    <span>本作品采用</span>
    <a href="https://creativecommons.org/licenses/by/4.0/">知识共享署名 4.0 国际许可协议</a>
    <span>进行许可。 转载时请注明原文链接。</span>
</div>
<div class="share" style="width: 100%;">
  <img src="https://i.loli.net/2020/04/07/6gyrxHXtAB1ZjUQ.jpg" alt="IamCoder" style="margin: auto; display: block;"/>
  <div style="margin: auto; text-align: center; font-size: 0.8em; color: grey;">老铁们关注走一走，不迷路</div>
</div>
  
    <div class="post-nav">
      <div class="post-nav-item post-nav-next">
        
          <span>〈 </span>
          <a href="/2019/11/13/WEB架构演进之路/" rel="next" title="WEB架构演进之路">
          WEB架构演进之路
          </a>
        
      </div>
  
      <div class="post-nav-item post-nav-prev">
          
          <a href="/2019/11/18/聊一聊微服务与分布式/" rel="prev" title="聊一聊微服务与分布式">
            聊一聊微服务与分布式
          </a>
          <span>〉</span>
        
      </div>
    </div>
  

</script>

    </div>

    
    
  </div>
  
  <footer class="footer text-center">
    <div id="bottom-inner">
        <a class="bottom-item" href="https://thevay.github.io/">首页</a> |
        <a class="bottom-item" href="https://github.com/thevay" target="_blank">GitHub</a> |
        <a class="bottom-item" href="#>">联系邮箱:thevay@163.com</a>
    </div>
    <!-- 不蒜子统计 -->
    本站总访问量<span id="busuanzi_value_site_pv"></span>次
    <span class="post-meta-divider">|</span>
    本站访客数<span id="busuanzi_value_site_uv"></span>人
</footer>
  

<script>
  (function(window, document, undefined) {

    var timer = null;

    function returnTop() {
      cancelAnimationFrame(timer);
      timer = requestAnimationFrame(function fn() {
        var oTop = document.body.scrollTop || document.documentElement.scrollTop;
        if (oTop > 0) {
          document.body.scrollTop = document.documentElement.scrollTop = oTop - 50;
          timer = requestAnimationFrame(fn);
        } else {
          cancelAnimationFrame(timer);
        }
      });
    }

    var hearts = [];
    window.requestAnimationFrame = (function() {
      return window.requestAnimationFrame ||
        window.webkitRequestAnimationFrame ||
        window.mozRequestAnimationFrame ||
        window.oRequestAnimationFrame ||
        window.msRequestAnimationFrame ||
        function(callback) {
          setTimeout(callback, 1000 / 60);
        }
    })();
    init();

    function init() {
      css(".heart{z-index:9999;width: 10px;height: 10px;position: fixed;background: #f00;transform: rotate(45deg);-webkit-transform: rotate(45deg);-moz-transform: rotate(45deg);}.heart:after,.heart:before{content: '';width: inherit;height: inherit;background: inherit;border-radius: 50%;-webkit-border-radius: 50%;-moz-border-radius: 50%;position: absolute;}.heart:after{top: -5px;}.heart:before{left: -5px;}");
      attachEvent();
      gameloop();
      addMenuEvent();
    }

    function gameloop() {
      for (var i = 0; i < hearts.length; i++) {
        if (hearts[i].alpha <= 0) {
          document.body.removeChild(hearts[i].el);
          hearts.splice(i, 1);
          continue;
        }
        hearts[i].y--;
        hearts[i].scale += 0.004;
        hearts[i].alpha -= 0.013;
        hearts[i].el.style.cssText = "left:" + hearts[i].x + "px;top:" + hearts[i].y + "px;opacity:" + hearts[i].alpha + ";transform:scale(" + hearts[i].scale + "," + hearts[i].scale + ") rotate(45deg);background:" + hearts[i].color;
      }
      requestAnimationFrame(gameloop);
    }

    /**
     * 给logo设置点击事件
     * 
     * - 回到顶部
     * - 出现爱心
     */
    function attachEvent() {
      var old = typeof window.onclick === "function" && window.onclick;
      var logo = document.getElementById("logo");
      if (logo) {
        logo.onclick = function(event) {
          returnTop();
          old && old();
          createHeart(event);
        }
      }
      
    }

    function createHeart(event) {
      var d = document.createElement("div");
      d.className = "heart";
      hearts.push({
        el: d,
        x: event.clientX - 5,
        y: event.clientY - 5,
        scale: 1,
        alpha: 1,
        color: randomColor()
      });
      document.body.appendChild(d);
    }

    function css(css) {
      var style = document.createElement("style");
      style.type = "text/css";
      try {
        style.appendChild(document.createTextNode(css));
      } catch (ex) {
        style.styleSheet.cssText = css;
      }
      document.getElementsByTagName('head')[0].appendChild(style);
    }

    function randomColor() {
      // return "rgb(" + (~~(Math.random() * 255)) + "," + (~~(Math.random() * 255)) + "," + (~~(Math.random() * 255)) + ")";
      return "#F44336";
    }

    function addMenuEvent() {
      var menu = document.getElementById('menu-main-post');
      if (menu) {
        var toc = document.getElementById('toc');
        if (toc) {
          menu.onclick = function() {
            if (toc) {
              if (toc.style.display == 'block') {
                toc.style.display = 'none';
              } else {
                toc.style.display = 'block';
              }
            }
          };
        } else {
          menu.style.display = 'none';
        }
      }
    }

  })(window, document);
</script>

  



</body>
</html>
